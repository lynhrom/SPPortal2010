window.postPlatformApp.register("googleAnalytics",function(c){var d=c._,g,e;g={init:function(a){c.state.set(a);d.bindAll(this,["gaTrack","twitterTrack","facebookTrack"]);c.subscribe({"googleAnalytics.track":this.gaTrack,"googleAnalytics.twitter.track":this.twitterTrack,"googleAnalytics.facebook.track":this.facebookTrack})},gaTrack:function(a,b){var f=c.state.get("gaTrackingId"),h=window.GoogleAnalyticsObject?"universal":"classic",e={service:a.service,url:d.removeTrackingParameter(a.url||window.location.toString()),
action:a.shareAction||"Po.st"};if(c.state.get("trackEvents")||c.state.get("trackSocialInteractions"))f=f?d.stringToArray(f):void 0,d.each(g.getTrackers(f,h),function(a){g.processTrackers(a,e,h,b)})},getTrackers:function(a,b){var c=a?[]:e[b].getAllTrackers();a&&d.each(a,function(a){c.push(e[b].getTrackerById(a))});return c},processTrackers:function(a,b,f,d){c.state.get("trackEvents")&&!d&&e[f].gaTrackEvent(a,b);c.state.get("trackSocialInteractions")&&e[f].gaTrackSocial(a,b)},facebookTrack:function(){c.state.get("trackSocialInteractions")&&
!c.state.get("fbSubscribed")&&(window.FB.Event.subscribe("edge.create",function(a){this.gaTrack({shareAction:"like",url:a,service:"Facebook"},!0)}.bind(this)),window.FB.Event.subscribe("edge.remove",function(a){this.gaTrack({shareAction:"unlike",url:a,service:"Facebook"},!0)}.bind(this)),window.FB.Event.subscribe("message.send",function(a){this.gaTrack({shareAction:"send",url:a,service:"Facebook"},!0)}.bind(this)),c.state.set({fbSubscribed:!0}))},twitterTrack:function(){c.state.get("trackSocialInteractions")&&
!c.state.get("twitterSubscribed")&&(window.twttr.ready(function(){window.twttr.events.bind("tweet",function(a){var b;a&&(a.target&&"IFRAME"===a.target.nodeName&&(b=d.extractParamFromUri(a.target.src,"url")),this.gaTrack({shareAction:"tweet",url:b,service:"Twitter"},!0))}.bind(this))}.bind(this)),c.state.set({twitterSubscribed:!0}))}};e={universal:{gaTrackSocial:function(a,b){a.send("social",b.action,b.service,b.url,{page:c.state.get("trackOptions.pagePath")})},gaTrackEvent:function(a,b){a.send("event",
"Po.st",b.service,b.url,void 0,{nonInteraction:c.state.get("trackOptions.nonInteraction")})},getTrackerById:function(a){return window[window.GoogleAnalyticsObject].create(a,"auto")},getAllTrackers:function(){return window[window.GoogleAnalyticsObject].getAll()}},classic:{gaTrackSocial:function(a,b){a._trackSocial(b.action,b.service,b.url,c.state.get("trackOptions.pagePath"))},gaTrackEvent:function(a,b){a._trackEvent("Po.st",b.service,b.url,void 0,c.state.get("trackOptions.nonInteraction"))},getTrackerById:function(a){if(window._gat&&
window._gat._createTracker)return window._gat._createTracker(a);if(window._gaq&&window._gaq._createAsyncTracker)return window._gaq._createAsyncTracker(a)},getAllTrackers:function(){if(window._gat&&window._gat._createTracker)return window._gat._getTrackers();if(window._gaq&&window._gaq._createAsyncTracker)return window._gaq._createAsyncTracker()}}};return{init:function(){c.subscribe("googleAnalytics.init",function(a){g.init(a.options)})},destroy:function(){}}});